---
layout: post
title:  "包和模块"
date:   2016-03-29 11:55:25 +0800
finished: "☆"
tag: 'how-npm-works'
order: '01'
---

在生态系统中，一个关键的步骤是学习它的句法。
One of the key steps in becoming immersed in an ecosystem is learning its vocabulary. Node.js and npm have very specific definitions of packages and modules, which are easy to mix up. We'll discuss those definitions here, make them distinct, and explain why certain default files are named the way they are.

<h3 id="tl-dr">[tl;dr](#tl-dr)</h3>

- 每个包都是使用 `package.json` 描述的一个文件或者目录。这可能有许多不同的方式！更多信息请查看下方的["什么是包?"](#what-is-a-package)

- 模块是任何可以被 Node.js 中 `reqiure()` 函数载入的文件和目录。

- A module is any file or directory that can be loaded by Node.js' require(). Again, there are several configurations that allow this to happen. For more info, see "What is a module?", below.

<h3 id="what-is-a-package">[什么是包?](#what-is-a-package)</h3>

包:

* a) a folder containing a program described by a package.json file
* b) a gzipped tarball containing (a)
* c) a url that resolves to (b)
* d) a <name>@<version> that is published on the registry with (c)
* e) a <name>@<tag> that points to (d)
* f) a <name> that has a latest tag satisfying (e)
* g) a git url that, when cloned, results in (a).

Noting all these package possibilities, it follows that even if you never publish your package to the public registry, you can still get a lot of benefits of using npm:

- if you just want to write a node program, and/or
- if you also want to be able to easily install it elsewhere after packing it up into a tarball

Git urls can be of the form:

``` bash
git://github.com/user/project.git#commit-ish
git+ssh://user@hostname:project.git#commit-ish
git+http://user@hostname/project/blah.git#commit-ish
git+https://user@hostname/project/blah.git#commit-ish
```
The commit-ish can be any tag, sha, or branch which can be supplied as an argument to git checkout. The default is master.

<h3 id="what-is-a-module">[What is a module?](#what-is-a-module)</h3>

A module is anything that can be loaded with require() in a Node.js program. The following are all examples of things that can be loaded as modules:

- A folder with a package.json file containing a main field.
- A folder with an index.js file in it.
- 一个 JavaScript 文件

<h4 id="most-npm-packages-are-modules">[大部分 npm 包都是模块](#most-npm-packages-are-modules)</h4>

Generally, npm packages that are used in Node.js program are loaded with require, making them modules. However, there's no requirement that an npm package be a module!

Some packages, e.g., cli packages only contain an executable command-line interface, and don't provide a main field for use in Node.js programs. These packages are not modules.

Almost all npm packages (at least, those that are Node programs) contain many modules within them (because every file they load with require() is a module).

In the context of a Node program, the module is also the thing that was loaded from a file. For example, in the following program:

``` javascript
var req = require('request')
```

we might say that "The variable req refers to the request module".

<h3 id="file-and-directory-names-in-the-nodejs-and-npm-ecosystem">[Node.js 和 npm 生态系统中文件和目录的命名](#file-and-directory-names-in-the-nodejs-and-npm-ecosystem)</h3>

- 所以为什么他们叫 `node_modules` 和 `package.json`
- 而不是 `node_packages` 或者 `module.json`

`package.json` 文件定义了包。(请看上方的 - ["什么是包?"](#what-is-a-package))

而 `node_modules` 文件夹是 Node.js 寻找模块的地方。(请看上方的 - ["什么是模块?"](#what-is-a-module))

举个例子，如果你在 node_modules 下面创建了 foo.js（node_modules/foo.js）,之后有一段程序执行了 `var f = require('foo.js')`，那么他会载入这个模块。
但是显然 foo.js 在这个例子中并不是一个“包”，因为根本没有 package.json。

除此之外，如果你创建的包中没有包含 index.js 而且 package.json 中也没有指定“main” 字段。那它也不能称之为一个模块。因为即使你在 node_modules 中安装了它，
它也没有认可可供 `require()` 使用的参数。
